<!DOCTYPE html>
<html lang="de" data-base="../">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Soccer Slime | Fynn Hofmann</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="../styles.css" />
  <style>
    /* â”€â”€ Game-specific tokens â”€â”€ */
    :root {
      --cyan:  #00CED1;
      --red:   #DC143C;
      --field: #1a6b3a;
    }

    /* â”€â”€ Game body overrides â”€â”€ */
    body { overflow-x: hidden; min-height: 100svh; }

    /* â”€â”€ Page wrapper â”€â”€ */
    .game-page {
      min-height: 100svh;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 80px 24px 48px;
    }

    /* â”€â”€ Screens â”€â”€ */
    .screen { display: none; flex-direction: column; align-items: center; width: 100%; max-width: 680px; }
    .screen.active { display: flex; }

    /* â”€â”€ Section label (reused from main CSS) â”€â”€ */
    .game-eyebrow {
      display: block;
      font-size: 12px;
      font-weight: 600;
      letter-spacing: 0.1em;
      text-transform: uppercase;
      color: var(--accent);
      margin-bottom: 14px;
      text-align: center;
    }
    .game-title {
      font-size: clamp(42px, 8vw, 72px);
      font-weight: 700;
      letter-spacing: -0.04em;
      line-height: 0.96;
      margin-bottom: 16px;
      text-align: center;
      background: linear-gradient(160deg, #1d1d1f 30%, #555 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }
    .game-subtitle {
      font-size: 16px;
      font-weight: 300;
      color: var(--text-secondary);
      text-align: center;
      margin-bottom: 40px;
    }

    /* â”€â”€ Mode buttons â”€â”€ */
    .game-mode-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 16px;
      width: 100%;
      margin-bottom: 20px;
    }
    .game-mode-card {
      background: var(--bg-light);
      border: 1.5px solid var(--border);
      border-radius: var(--radius);
      padding: 28px 24px;
      cursor: pointer;
      transition: box-shadow var(--transition), transform var(--transition), border-color var(--transition);
      text-align: left;
      font-family: var(--font);
    }
    .game-mode-card:hover {
      box-shadow: 0 8px 32px rgba(0,0,0,0.10);
      transform: translateY(-2px);
      border-color: var(--accent);
    }
    .game-mode-emoji { font-size: 36px; display: block; margin-bottom: 14px; }
    .game-mode-title { font-size: 18px; font-weight: 600; letter-spacing: -0.01em; color: var(--text); margin-bottom: 6px; }
    .game-mode-desc  { font-size: 13px; color: var(--text-secondary); line-height: 1.5; }

    /* â”€â”€ Duration picker â”€â”€ */
    .game-section-title {
      font-size: 22px;
      font-weight: 600;
      letter-spacing: -0.02em;
      margin-bottom: 20px;
      text-align: center;
      color: var(--text);
    }
    .game-vs {
      font-size: 15px;
      color: var(--text-secondary);
      margin-bottom: 28px;
      text-align: center;
    }
    .game-duration-grid {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      justify-content: center;
      margin-bottom: 28px;
    }
    .game-dur-btn {
      padding: 10px 20px;
      background: var(--bg-light);
      border: 1.5px solid var(--border);
      border-radius: 980px;
      font-family: var(--font);
      font-size: 14px;
      font-weight: 500;
      color: var(--text);
      cursor: pointer;
      transition: border-color var(--transition), background var(--transition), color var(--transition), transform var(--transition);
    }
    .game-dur-btn:hover {
      border-color: var(--accent);
      color: var(--accent);
      transform: translateY(-1px);
    }

    /* â”€â”€ Controls hint â”€â”€ */
    .game-controls-card {
      background: var(--bg-light);
      border-radius: var(--radius-sm);
      padding: 18px 24px;
      width: 100%;
      margin-bottom: 24px;
    }
    .game-controls-card p {
      font-size: 13px;
      color: var(--text-secondary);
      line-height: 1.7;
    }
    .game-controls-card strong {
      font-weight: 600;
      color: var(--text);
    }

    /* â”€â”€ Back button â”€â”€ */
    .game-btn-back {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      color: var(--accent);
      background: none;
      border: none;
      font-family: var(--font);
      font-size: 14px;
      font-weight: 500;
      cursor: pointer;
      padding: 0;
      transition: gap 0.2s;
    }
    .game-btn-back:hover { gap: 10px; }

    /* â”€â”€ Scorebar â”€â”€ */
    .game-scorebar {
      width: 800px;
      max-width: 100%;
      background: var(--bg-dark);
      border-radius: var(--radius) var(--radius) 0 0;
      padding: 16px 28px;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }
    .game-score-team {
      font-size: 15px;
      font-weight: 600;
      letter-spacing: -0.01em;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    .game-score-num {
      font-size: 28px;
      font-weight: 700;
      letter-spacing: -0.03em;
      font-variant-numeric: tabular-nums;
    }
    .game-timer {
      font-family: "SF Mono", "Fira Code", monospace;
      font-size: 22px;
      font-weight: 600;
      color: #f5f5f7;
      letter-spacing: 0.04em;
    }
    .game-team-dot {
      width: 10px; height: 10px;
      border-radius: 50%;
      display: inline-block;
    }

    /* â”€â”€ Canvas â”€â”€ */
    canvas {
      display: block;
      max-width: 100%;
      border-radius: 0 0 var(--radius) var(--radius);
    }

    /* â”€â”€ Winner overlay â”€â”€ */
    .game-winner-card {
      margin-top: 32px;
      background: var(--bg-light);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      padding: 48px 40px;
      text-align: center;
      width: 100%;
      max-width: 480px;
      animation: fadeUp 0.5s var(--ease) forwards;
    }
    @keyframes fadeUp {
      from { opacity: 0; transform: translateY(20px); }
      to   { opacity: 1; transform: translateY(0); }
    }
    .game-winner-emoji { font-size: 56px; display: block; margin-bottom: 16px; }
    .game-winner-title {
      font-size: 28px;
      font-weight: 700;
      letter-spacing: -0.03em;
      margin-bottom: 8px;
      color: var(--text);
    }
    .game-winner-score {
      font-size: 15px;
      color: var(--text-secondary);
      margin-bottom: 28px;
    }
    .game-winner-actions { display: flex; gap: 12px; justify-content: center; flex-wrap: wrap; }

    /* â”€â”€ Buttons (reused style) â”€â”€ */
    .btn-primary {
      display: inline-flex; align-items: center;
      padding: 12px 24px;
      background: var(--accent);
      color: #fff;
      border: none;
      border-radius: 980px;
      font-size: 15px; font-weight: 500;
      font-family: var(--font);
      text-decoration: none; cursor: pointer;
      transition: var(--transition);
    }
    .btn-primary:hover { background: var(--accent-hover); transform: translateY(-1px); }

    .btn-secondary {
      display: inline-flex; align-items: center;
      padding: 12px 24px;
      background: rgba(0,0,0,0.06);
      color: var(--text);
      border: none;
      border-radius: 980px;
      font-size: 15px; font-weight: 500;
      font-family: var(--font);
      text-decoration: none; cursor: pointer;
      transition: var(--transition);
    }
    .btn-secondary:hover { background: rgba(0,0,0,0.10); transform: translateY(-1px); }

    /* â”€â”€ Responsive â”€â”€ */
    @media (max-width: 860px) {
      .game-mode-grid { grid-template-columns: 1fr; }
      .game-scorebar { padding: 12px 16px; }
      .game-score-num { font-size: 22px; }
    }
    @media (max-width: 600px) {
      .game-score-team { font-size: 13px; }
      .game-timer { font-size: 17px; }
    }
  </style>
</head>
<body>

<main class="game-page">

  <!-- â”€â”€ SCREEN: MENU â”€â”€ -->
  <div id="screen-menu" class="screen active">
    <span class="game-eyebrow">Mini-Game</span>
    <h1 class="game-title">Soccer Slime</h1>
    <p class="game-subtitle">Zwei Schleim-Teams. Ein Ball. Kein Erbarmen.</p>
    <div class="game-mode-grid">
      <button class="game-mode-card" id="btn-single">
        <span class="game-mode-emoji">ğŸ¤–</span>
        <div class="game-mode-title">Einzelspieler</div>
        <div class="game-mode-desc">Du gegen eine KI â€” Pfeiltasten zur Steuerung.</div>
      </button>
      <button class="game-mode-card" id="btn-multi">
        <span class="game-mode-emoji">ğŸ®</span>
        <div class="game-mode-title">Mehrspieler</div>
        <div class="game-mode-desc">Zwei Spieler, eine Tastatur â€” lokal am selben GerÃ¤t.</div>
      </button>
    </div>
  </div>

  <!-- â”€â”€ SCREEN: DURATION â”€â”€ -->
  <div id="screen-mode" class="screen">
    <span class="game-eyebrow">Spieldauer</span>
    <h2 class="game-section-title">Wie lange soll gespielt werden?</h2>
    <p class="game-vs">
      <span style="color:var(--cyan);font-weight:600">Cyan</span>
      <span style="color:var(--text-tertiary);margin:0 8px">vs</span>
      <span style="color:var(--red);font-weight:600">Rot</span>
    </p>
    <div class="game-duration-grid">
      <button class="game-dur-btn" data-sec="60">1 Minute</button>
      <button class="game-dur-btn" data-sec="120">2 Minuten</button>
      <button class="game-dur-btn" data-sec="240">4 Minuten</button>
      <button class="game-dur-btn" data-sec="480">8 Minuten</button>
      <button class="game-dur-btn" data-sec="300">âš½ World Cup</button>
    </div>
    <div class="game-controls-card" id="ctrl-card">
      <p id="ctrl-hint"></p>
    </div>
    <button class="game-btn-back" id="btn-back">â† ZurÃ¼ck</button>
  </div>

  <!-- â”€â”€ SCREEN: GAME â”€â”€ -->
  <div id="screen-game" class="screen">
    <div class="game-scorebar">
      <div class="game-score-team" style="color:#f5f5f7">
        <span class="game-team-dot" style="background:var(--cyan)"></span>
        Cyan
        <span class="game-score-num" id="score-l">0</span>
      </div>
      <span class="game-timer" id="timer">00:00</span>
      <div class="game-score-team" style="color:#f5f5f7">
        <span class="game-score-num" id="score-r">0</span>
        Rot
        <span class="game-team-dot" style="background:var(--red)"></span>
      </div>
    </div>
    <canvas id="cv" width="800" height="400"></canvas>

    <div id="winner-card" class="game-winner-card" style="display:none">
      <span class="game-winner-emoji" id="winner-emoji"></span>
      <h2 class="game-winner-title" id="winner-text"></h2>
      <p class="game-winner-score" id="winner-score"></p>
      <div class="game-winner-actions">
        <button class="btn-primary"   id="btn-play-again">Nochmal spielen</button>
        <button class="btn-secondary" id="btn-menu">Zum MenÃ¼</button>
      </div>
    </div>
  </div>

</main>

<script>
// â”€â”€ Constants â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const GW=800,GH=400,GND=80,SR=40,BR=10,GW2=80,GH2=120;
const GRAV=0.6,SPD=5,JUMP=-12,DAMP=0.99,BDAMP=0.8,MAXSPD=13;

// â”€â”€ State â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
let playerMode='single', score={l:0,r:0}, timeLeft=0, timerInterval=null, running=false, lastSec=-1;
let gs;

function initGs(){
  gs={
    ls:{x:200,y:GH-GND,vx:0,vy:0,grab:false,hasBall:false,glt:0,tx:200,cd:0,fresh:true,lastBy:GH-GND,stuck:0},
    rs:{x:600,y:GH-GND,vx:0,vy:0,grab:false,hasBall:false,glt:0},
    ball:{x:GW/2,y:150,vx:0,vy:0,held:null,ang:0,angV:0}
  };
}

// â”€â”€ Keys â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const keys={};
window.addEventListener('keydown',e=>{if(e.target.tagName==='INPUT')return;e.preventDefault();keys[e.key.toLowerCase()]=true;});
window.addEventListener('keyup',  e=>{if(e.target.tagName==='INPUT')return;e.preventDefault();keys[e.key.toLowerCase()]=false;});

// â”€â”€ Screen routing â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function show(id){
  document.querySelectorAll('.screen').forEach(s=>s.classList.remove('active'));
  document.getElementById('screen-'+id).classList.add('active');
}

// â”€â”€ Buttons â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
document.getElementById('btn-single').onclick=()=>{
  playerMode='single';
  document.getElementById('ctrl-hint').innerHTML=
    '<strong>Du spielst Rot (rechts)</strong><br>â†/â†’ bewegen Â· â†‘ springen Â· â†“ gedrÃ¼ckt halten = Ball fangen';
  show('mode');
};
document.getElementById('btn-multi').onclick=()=>{
  playerMode='multi';
  document.getElementById('ctrl-hint').innerHTML=
    '<strong>Cyan (links):</strong> A/D bewegen Â· W springen Â· S fangen<br>'+
    '<strong>Rot (rechts):</strong> â†/â†’ bewegen Â· â†‘ springen Â· â†“ fangen';
  show('mode');
};
document.getElementById('btn-back').onclick=()=>show('menu');
document.getElementById('btn-menu').onclick=()=>{stopGame();show('menu');};
document.getElementById('btn-play-again').onclick=()=>{
  const sec=lastSec; stopGame(); startGame(sec);
};

document.querySelectorAll('[data-sec]').forEach(btn=>{
  btn.onclick=()=>{ lastSec=parseInt(btn.dataset.sec); startGame(lastSec); };
});

// â”€â”€ Game lifecycle â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function startGame(secs){
  initGs(); score={l:0,r:0}; updateScoreUI();
  timeLeft=secs; updateTimerUI();
  document.getElementById('winner-card').style.display='none';
  show('game');
  running=true;
  clearInterval(timerInterval);
  timerInterval=setInterval(()=>{
    timeLeft--;
    updateTimerUI();
    if(timeLeft<=0){clearInterval(timerInterval);endGame();}
  },1000);
  requestAnimationFrame(loop);
}

function stopGame(){ running=false; clearInterval(timerInterval); }

function endGame(){
  running=false;
  const w=document.getElementById('winner-card');
  const emoji=document.getElementById('winner-emoji');
  const title=document.getElementById('winner-text');
  const sub=document.getElementById('winner-score');
  if(score.l>score.r){emoji.textContent='ğŸ†';title.textContent='Cyan gewinnt!';}
  else if(score.r>score.l){emoji.textContent='ğŸ†';title.textContent='Rot gewinnt!';}
  else {emoji.textContent='ğŸ¤';title.textContent='Unentschieden!';}
  sub.textContent=score.l+' : '+score.r+' â€“ Gut gespielt!';
  w.style.display='block';
}

function addGoal(side){
  score[side]++;
  updateScoreUI();
  initGs();
}

function updateScoreUI(){
  document.getElementById('score-l').textContent=score.l;
  document.getElementById('score-r').textContent=score.r;
}
function updateTimerUI(){
  const m=Math.floor(timeLeft/60),s=timeLeft%60;
  document.getElementById('timer').textContent=String(m).padStart(2,'0')+':'+String(s).padStart(2,'0');
}

// â”€â”€ AI â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function updateAI(){
  const ai=gs.ls,ball=gs.ball;
  if(ai.cd>0){
    ai.cd--;
    const d=ai.tx-ai.x;
    ai.vx=Math.abs(d)>10?Math.sign(d)*SPD*Math.min(Math.abs(d)/50,1):0;
    return;
  }
  if(ai.fresh&&timeLeft>55){
    ai.tx=200;ai.vx=0;
    if(Math.abs(ball.x-ai.x)<150||timeLeft<=55){ai.fresh=false;ai.cd=15;}
    return;
  }
  const ballH=GH-GND-ball.y,aiDist=Math.abs(ai.x-ball.x);
  const toOpp=Math.abs(ball.x-(GW-GW2/2)),toOwn=Math.abs(ball.x-GW2/2);
  const ballLeft=ball.vx<-1;
  if(Math.abs(ball.y-ai.lastBy)<5&&Math.abs(ball.vx)<2)ai.stuck++;
  else ai.stuck=0;
  ai.lastBy=ball.y;
  let newTx=ai.tx,jump=false;
  if(toOpp<toOwn*1.5||(ball.x>GW*0.35&&!ballLeft)){
    newTx=ball.x-(ballH>60&&aiDist<150?45:30);
    if(aiDist<100){
      if(ai.stuck>30){jump=true;newTx=ball.x-40;}
      else if((ballH>30&&ballH<90)||(ball.x>GW*0.6&&ballH<120)){
        if(ai.y>=GH-GND-1)jump=true;
      }
    }
  }else if(ball.x<GW*0.65||ballLeft){
    newTx=ball.x;
    if(ball.x<GW2*2.5&&ballLeft){
      newTx=Math.max(ball.x-10,SR);
      if(aiDist<120&&ballH<100)jump=true;
    }
  }else{newTx=GW*0.4;}
  if(Math.abs(newTx-ai.tx)>15){ai.tx=newTx;ai.cd=10;}
  const d=ai.tx-ai.x;
  ai.vx=Math.abs(d)>10?Math.sign(d)*SPD*Math.min(Math.abs(d)/50,1):0;
  if(jump&&ai.vy===0)ai.vy=JUMP;
}

// â”€â”€ Physics â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function physics(){
  const {ls,rs,ball}=gs;
  if(playerMode==='multi'){
    ls.vx=keys['a']?-SPD:keys['d']?SPD:0;
    if(keys['w']&&ls.y>=GH-GND-1&&!ls.grab)ls.vy=JUMP;
    ls.grab=!!keys['s'];
  }else{updateAI();}
  rs.vx=keys['arrowleft']?-SPD:keys['arrowright']?SPD:0;
  if(keys['arrowup']&&rs.y>=GH-GND-1&&!rs.grab)rs.vy=JUMP;
  rs.grab=!!keys['arrowdown'];

  [ls,rs].forEach((s,i)=>{
    s.vy+=GRAV;s.x+=s.vx;s.y+=s.vy;
    if(s.x<SR)s.x=SR; if(s.x>GW-SR)s.x=GW-SR;
    if(s.y>GH-GND){s.y=GH-GND;s.vy=0;}
    const inOwn=(i===0&&s.x<GW2)||(i===1&&s.x>GW-GW2);
    if(inOwn){s.glt+=1/60;if(s.glt>=1)addGoal(i===0?'r':'l');}
    else s.glt=0;
  });

  if(ball.held){
    const g=ball.held==='l'?ls:rs,dir=ball.held==='l'?1:-1;
    ball.angV+=-g.vx*0.008*dir; ball.angV*=0.85; ball.ang+=ball.angV;
    const dist=SR+BR-5;
    ball.x=g.x+Math.cos(ball.ang)*dist; ball.y=g.y+Math.sin(ball.ang)*dist;
    ball.vx=g.vx; ball.vy=g.vy;
    if(!g.grab){
      const sp=Math.abs(ball.angV)*20;
      ball.vx=g.vx*1.5+Math.cos(ball.ang)*(3+sp);
      ball.vy=g.vy-2+Math.sin(ball.ang)*sp*0.3;
      ball.held=null;ball.ang=0;ball.angV=0;g.hasBall=false;
    }
  }else{
    ball.vy+=GRAV;ball.vx*=DAMP;ball.x+=ball.vx;ball.y+=ball.vy;
  }
  if(ball.x<BR){ball.x=BR;ball.vx=-ball.vx*BDAMP;}
  if(ball.x>GW-BR){ball.x=GW-BR;ball.vx=-ball.vx*BDAMP;}
  if(ball.y>GH-GND-BR){ball.y=GH-GND-BR;ball.vy=-ball.vy*BDAMP;}
  if(ball.y<BR){ball.y=BR;ball.vy=-ball.vy*BDAMP;}
  if(ball.x<=BR&&ball.y>GH-GND-GH2){addGoal('r');return;}
  if(ball.x>=GW-BR&&ball.y>GH-GND-GH2){addGoal('l');return;}

  [ls,rs].forEach((s,i)=>{
    const sn=i===0?'l':'r',other=i===0?rs:ls;
    const dx=ball.x-s.x,dy=ball.y-s.y,dist=Math.sqrt(dx*dx+dy*dy);
    if(dist<SR+BR){
      if(ball.held&&ball.held!==sn){
        const sp=Math.sqrt(s.vx*s.vx+s.vy*s.vy);
        if(sp>2||Math.abs(s.vy)>5){
          ball.held=null;other.hasBall=false;
          const a=Math.atan2(dy,dx);ball.vx=Math.cos(a)*8+s.vx;ball.vy=Math.sin(a)*8+s.vy;
        }
      }else if(s.grab&&!ball.held){
        ball.held=sn;ball.ang=Math.atan2(dy,dx);ball.angV=0;s.hasBall=true;
      }else if(!ball.held){
        const a=Math.atan2(dy,dx);
        if(ball.y<s.y||Math.abs(a)<Math.PI*0.5){
          ball.x=s.x+Math.cos(a)*(SR+BR);ball.y=s.y+Math.sin(a)*(SR+BR);
          const sp=Math.sqrt(ball.vx*ball.vx+ball.vy*ball.vy);
          ball.vx=Math.cos(a)*sp*1.5+s.vx*0.5;ball.vy=Math.sin(a)*sp*1.5+s.vy*0.5;
          const ns=Math.sqrt(ball.vx*ball.vx+ball.vy*ball.vy);
          if(ns>MAXSPD){ball.vx*=MAXSPD/ns;ball.vy*=MAXSPD/ns;}
        }
      }
    }
  });
}

// â”€â”€ Draw â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const cv=document.getElementById('cv');
const ctx=cv.getContext('2d');

function drawField(){
  // Grass gradient
  const grd=ctx.createLinearGradient(0,0,0,GH-GND);
  grd.addColorStop(0,'#1a6b3a'); grd.addColorStop(1,'#155230');
  ctx.fillStyle=grd; ctx.fillRect(0,0,GW,GH-GND);

  // Subtle field stripes
  ctx.globalAlpha=0.06;
  for(let i=0;i<GW;i+=80){
    ctx.fillStyle='#fff';
    ctx.fillRect(i,0,40,GH-GND);
  }
  ctx.globalAlpha=1;

  // Center line
  ctx.strokeStyle='rgba(255,255,255,0.25)'; ctx.lineWidth=2; ctx.setLineDash([8,8]);
  ctx.beginPath(); ctx.moveTo(GW/2,0); ctx.lineTo(GW/2,GH-GND); ctx.stroke();
  ctx.setLineDash([]);

  // Center circle
  ctx.strokeStyle='rgba(255,255,255,0.18)'; ctx.lineWidth=2;
  ctx.beginPath(); ctx.arc(GW/2,GH/2-GND/2,55,0,Math.PI*2); ctx.stroke();

  // Ground
  const gr=ctx.createLinearGradient(0,GH-GND,0,GH);
  gr.addColorStop(0,'#5a4a3a'); gr.addColorStop(1,'#3d3228');
  ctx.fillStyle=gr; ctx.fillRect(0,GH-GND,GW,GND);

  // Ground line
  ctx.strokeStyle='rgba(255,255,255,0.15)'; ctx.lineWidth=3; ctx.setLineDash([]);
  ctx.beginPath(); ctx.moveTo(0,GH-GND); ctx.lineTo(GW,GH-GND); ctx.stroke();
}

function drawGoal(flip){
  const gx=flip?GW-GW2:0;
  // Net background
  ctx.fillStyle='rgba(255,255,255,0.06)';
  ctx.fillRect(gx,GH-GND-GH2,GW2/2,GH2);

  // Net grid
  ctx.strokeStyle='rgba(255,255,255,0.15)'; ctx.lineWidth=1;
  for(let x=gx;x<=gx+GW2/2;x+=10){ctx.beginPath();ctx.moveTo(x,GH-GND-GH2);ctx.lineTo(x,GH-GND);ctx.stroke();}
  for(let y=GH-GND-GH2;y<=GH-GND;y+=10){ctx.beginPath();ctx.moveTo(gx,y);ctx.lineTo(gx+GW2/2,y);ctx.stroke();}

  // Goal posts
  ctx.strokeStyle='rgba(255,255,255,0.9)'; ctx.lineWidth=3;
  ctx.beginPath();
  ctx.moveTo(gx,GH-GND); ctx.lineTo(gx+GW2,GH-GND);
  ctx.moveTo(gx+GW2/2,GH-GND); ctx.lineTo(gx+GW2/2,GH-GND-GH2);
  ctx.stroke();
}

function drawSlime(s,isRight,col,acc){
  // Shadow
  ctx.save();
  ctx.globalAlpha=0.18;
  ctx.fillStyle='#000';
  ctx.beginPath();
  ctx.ellipse(s.x,GH-GND+4,SR*0.85,8,0,0,Math.PI*2);
  ctx.fill();
  ctx.restore();

  // Body
  ctx.fillStyle=col;
  ctx.beginPath(); ctx.arc(s.x,s.y,SR,Math.PI,0); ctx.closePath(); ctx.fill();

  // Shine
  const shine=ctx.createRadialGradient(s.x-SR*0.28,s.y-SR*0.28,2,s.x,s.y,SR);
  shine.addColorStop(0,'rgba(255,255,255,0.35)');
  shine.addColorStop(1,'rgba(255,255,255,0)');
  ctx.fillStyle=shine;
  ctx.beginPath(); ctx.arc(s.x,s.y,SR,Math.PI,0); ctx.closePath(); ctx.fill();

  // Accent stripe
  ctx.fillStyle=acc;
  ctx.beginPath();
  ctx.arc(s.x,s.y,SR-5,Math.PI+0.3,Math.PI+0.7);
  ctx.arc(s.x,s.y,SR-15,Math.PI+0.7,Math.PI+0.3,true);
  ctx.closePath(); ctx.fill();

  // Eye white
  const ex=s.x+(isRight?-SR*0.3:SR*0.3);
  ctx.fillStyle='#fff';
  ctx.beginPath(); ctx.arc(ex,s.y-SR*0.3,6,0,Math.PI*2); ctx.fill();
  // Pupil
  ctx.fillStyle='#1d1d1f';
  ctx.beginPath(); ctx.arc(s.x+(isRight?-SR*0.35:SR*0.35),s.y-SR*0.3,2.5,0,Math.PI*2); ctx.fill();
}

function drawBall(b){
  // Shadow
  ctx.save(); ctx.globalAlpha=0.2;
  ctx.fillStyle='#000';
  ctx.beginPath(); ctx.ellipse(b.x,GH-GND+3,BR*1.2,5,0,0,Math.PI*2); ctx.fill();
  ctx.restore();

  // Ball
  ctx.fillStyle='#FFD700';
  ctx.beginPath(); ctx.arc(b.x,b.y,BR,0,Math.PI*2); ctx.fill();

  // Shine
  ctx.fillStyle='rgba(255,255,255,0.5)';
  ctx.beginPath(); ctx.arc(b.x-BR*0.3,b.y-BR*0.3,BR*0.38,0,Math.PI*2); ctx.fill();
}

function draw(){
  drawField();
  drawGoal(false); drawGoal(true);
  drawSlime(gs.ls,false,'#00CED1','#008B8B');
  drawSlime(gs.rs,true, '#DC143C','#8B0000');
  drawBall(gs.ball);
}

// â”€â”€ Loop â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
let lastFrame=0;
function loop(t){
  if(!running)return;
  if(t-lastFrame>=1000/60){physics();draw();lastFrame=t;}
  requestAnimationFrame(loop);
}

// â”€â”€ Init â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
show('menu');
</script>
<script src="../components.js"></script>
</body>
</html>